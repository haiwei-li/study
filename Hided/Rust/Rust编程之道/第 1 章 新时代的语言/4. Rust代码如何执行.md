
# 整体来说

Rust 是跨平台语言, 一次编译, 多处运行, 这得益于 LLVM: **Rust 编译器**是一个 **LLVM 编译前端**, 它将代码编译成 `LLVM IR`, 然后经过 **LLVM 编译**为相应的平台目标. 

> LLVM, 是一套编译器基础设施项目, 以 C++ 写成, 包含一系列模块化的编译器组件和工具链, 用来开发编译器前端和后端. 它是为了任意一种编程语言而写成的程序, 利用虚拟技术创造出编译时期、链接时期、运行时期以及"闲置时期"的优化. 最初是(Low Level Virtual Machine, 底层虚拟机), 后成为众多编译工具及低端工具技术的统称.
>
> https://github.com/llvm/llvm-project

# 编译过程

**Rust 源码**经过分词和解析, 生成 `AST`(**抽象语法树**).

然后把 AST 进一步处理为 **HIR**(`High-level IR`), 目的是让编译器更方便地做**类型检查**.

HIR会进一步被编译为 **MIR**(`Middle IR`), 这是一种中间表示, 在 Rust 1.12 中被引入, 主要用于:

* 缩短编译时间. MIR 可以帮助实现增量编译, 即只计算更改过的部分.

* 缩短执行时间. LLVM 的优化粒度太粗, MIR 可以在 LLVM 编译之前实现更细粒度的优化, 且 Rust 可控.

* 更精确的类型检查. 

最终, MIR 被翻译为 **LLVM IR**, 然后被 **LLVM 编译**为可在各个平台上运行的**目标机器码**.



虚拟化(Virtualization)是资源的逻辑表示, 它不受物理限制的约束.

计算机科学家David Wheeler有一句名言: "**计算机科学**中的**任何问题**都可以通过**增加一个中间层**来解决. "这句话也说明了虚拟化的思想存在于计算机科学中的各个领域.

虚拟化的主要思想是, 在**系统**中加入一个**虚拟化层**, 虚拟化层将**下层的资源**抽象成另一种形式的资源, 提供给**上层使用**. 通过空间上分割、时间上分时以及模拟, 虚拟化可以将一份资源抽象成多份. 反过来, 虚拟化也可以将多份资源抽象成一份. 本质上, 计算机的发展过程也是虚拟化不断发展的过程.

CPU内部遍布的数字逻辑电路只能够识别二进制数据 0、1, 机器码是计算机唯一能够识别的数据. 汇编语言的出现让程序员能够比较简单地实现CPU的执行和内存访问. C语言的出现进一步方便了程序员, 使得程序员可以从具体CPU架构指令脱离出来, 大部分情况下只需要考虑业务即可. Python、Java等现代高级语言更是重新定义了自己的指令, 由各个平台的虚拟机去解释执行, 实现了完全的跨平台. 从机器码、汇编语言到C语言, 再到高级语言, 其本质就是一个不断虚拟的过程, 将底层复杂的接口转变成了上层容易使用的接口.

硬盘由柱面、磁道、扇区构成, 里面存放着文件等数据信息, 计算机用户在进行文件访问的时候并不需要关心这些底层细节. 这些细节经过操作系统的抽象, 变成了文件与目录的概念, 使得复杂的硬盘数据管理变得简单方便, 应用程序能够通过文件管理的接口方便地创建、读取、写入文件, 这本质上也是一种虚拟.

TCP/IP协议栈模型是另一个虚拟化的例子. 网卡设备传递的都是二进制数据, 经过网络层、传输层的抽象之后, 应用程序不需要直接跟网络数据包的收发细节打交道, 只需要关心协议栈最上层的接口, 也不需要关心其他使用网卡设备的程序, 只需要将要发送的数据和地址提供给协议栈, 协议栈会自动处理好IP路由、分片等细节.

现代操作系统中都有很多进程, 每一个进程都是对计算机的抽象, 进程都认为自己独占整个计算机系统的资源, 有着独立的CPU和内存. 但这些都是操作系统呈现给进程的假象, 操作系统通过在各个进程之间共享CPU, 为每个进程创建独立的虚拟内存, 这不仅能够实现资源的充分利用, 也能够实现进程之间的安全隔离.

操作系统会提供一组接口给应用程序, 方便开发者编写应用程序, 比如创建进程操作文件、发送网络数据等, 这种抽象本质上也是虚拟化的一种体现. 开发者只需要关注上层的接口而不需要关心底层的细节实现. 这样底层的实现即使发生了变化, 也不会影响上层应用程序的运行, 如Wine项目和Cygwin项目, 前者能够让为Windows编写的程序运行在Linux上, 后者能够让为Linux编写的程序运行在Windows上.

以上的例子都是虚拟化思想的体现. 底层的资源或者通过空间的分割, 或者通过时间的分割, 将下层的资源通过一种简单易用的方式转换成另一种资源, 提供给上层使用. 经典的操作系统书籍Operating Systems: Three Easy Pieces从三个方面讲述了操作系统的基本原理, 第一部分即是虚拟化思想, 其他两部分是并行和持久化.

虚拟化技术以各种形式存在已经有四十年之久了, 目前出现了服务器虚拟化、网络虚拟化、微处理器虚拟化文件虚拟化和存储虚拟化等技术.

系统虚拟化是虚拟化技术中的一种, 其抽象粒度是整个计算机.








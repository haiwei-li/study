
为了支持需要隔离的用途, 平台必须能够唯一地标识每个 DMA 请求的请求者 (Source-Id). 平台中的 DMA 源以及这些请求中 source-id 的使用可分为以下几类. 





# 使用 Phantom 功能的 PCI Express 设备

为了增加需要完成的未完成请求的最大可能数量, PCI Express 允许设备使用未分配给已实现功能的功能编号来逻辑扩展标签标识符. 未声明的功能编号称为幻像功能编号 (PhFN). 设备通过设备功能配置寄存器报告其对幻像功能的支持, 并要求软件通过设备控制配置寄存器明确启用幻像功能的使用. 

由于功能编号是用于定位用于处理 DMA 请求的上下文条目的请求者 ID 的一部分, 因此在分配启用了幻像功能的 PCI Express 设备时, 软件必须编程多个上下文条目, 每个条目都对应于启用以供设备功能使用的 PhFN. 每个上下文条目都必须以相同的方式编程, 以确保具有任何这些请求者 ID 的 DMA 请求都以相同的方式处理. 




**protected mode**(保护模式)在整个 x86/x64 体系是最为重要的处理器工作模式, 在**x64 体系**中的**long mode**也是构建在**protected mode 之上**, 实质上是**扩展的保护模式**. 在保护模式里可以使用处理器提供的全部资源.

>问题 1: 保护模式下保护什么?

实质上就是保护处理器的某些资源不能被随意访问, 包括处理器的硬件资源和系统的软件资源, 典型地像 CR0 这些系统控制寄存器. 一些系统级的数据结构, 譬如: GDT、IDT 需要被保护起来, 以及 OS kernel 的执行代码和数据等.

>问题 2: 根据什么来保护?

x86/x64 处理器定义了 4 个权限级别: 从 0 级到 3 级, 也被称为 ring 0 到 ring 3. 0 级具有最高的权限, 3 级是最低权限. 拥有高权限的代码可以对低权限的数据进行访问, 反之则不行. 被赋予 0 级权限访问的资源只有具有 0 级权限的代码才能访问, 譬如一些特权级指令.

>问题 3: 如何实施保护措施?

这就是这一章里重点探讨的环节, 保护模式下实施了种种访问限制, 对一些违例访问的行为处理器产生相应的异常进行提示和处理. #GP 异常是保护模式下最常见的异常. 而对一些数据的访问需要经过某些途径才能获得.

而 x86 的 segmentation(段式管理)和 paging(分页管理)是实施保护措施的手段和途径, 在 segmentation 机制和 paging 机制下实行了不同的内存管理模式和访问控制. 对资源的访问需先经过 segmentation 阶段再到 paging 阶段(在开启 paging 机制的前提下). 在**x64 体系**之下, long mode 刻意地**弱化了一些 segmentation 阶段的限制行为**, 将重点放在了**paging 阶段**里.
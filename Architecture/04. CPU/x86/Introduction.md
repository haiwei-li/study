## 1. 概念

汇编语言(assembly language)是一种用于电子计算机、微处理器、微控制器或其他可编程器件的低级语言亦称为符号语言. 在汇编语言中用助记符(Mnemonics)代替机器指令的操作码用地址符号(Symbol)或标号(Label)代替指令或操作数的地址.

## 2. 特点

不同的设备中汇编语言对应着不同的机器语言指令集通过汇编过程转换成机器指令. 普遍地说特定的汇编语言和特定的机器语言指令集是一一对应的不同平台之间不可直接移植.

汇编语言的主体是汇编指令. 汇编指令和机器指令的差别在于指令的表示方法上. 汇编指令是机器指令便于记忆的书写格式.

```
操作: 寄存器 BX 的内容送到 AX 中

1000100111011000              机器指令

mov ax,bx                     汇编指令
```

汇编语言写出源程序再用汇编编译器将其编译为机器码由计算机最终执行.

汇编语言是直接**面向处理器**(Processor)的程序设计语言. 处理器是在指令的控制下工作的处理器可以识别的每一条指令称为机器指令. 每一种处理器都有自己可以识别的一整套指令称为指令集.

汇编语言的另一个特点就是它所操作的对象不是具体的数据,而是寄存器或者存储器即直接和寄存器和存储器打交. 既然数据是存放在寄存器或存储器中那么必然就存在着寻址方式也就是用什么方法找到所需要的数据. 例如上面的例子我们就不能像高级语言一样直接使用数据而是先要从相应的寄存器 AX、BX 中把数据取出. 这也就增加了编程的复杂性因为在高级语言中寻址这部分工作是由编译系统来完成的而在汇编语言中是由程序员自己来完成的这无异增加了编程的复杂程度和程序的可读性.

汇编语言指令是机器指令的一种符号表示而不同类型的 CPU 有不同的机器指令系统也就有不同的汇编语言,所以汇编语言程序与机器有着密切的关系. 所以除了同系列、不同型号 CPU 之间的汇编语言程序有一定程度的可移植性之外其它不同类型(如: 小型机和微机等)CPU 之间的汇编语言程序是无法移植的也就是说汇编语言程序的通用性和可移植性要比高级语言程序低.

## 3. 指令

### 数据传送指令

包括通用数据传送指令 MOV、条件传送指令 CMOVcc、堆栈操作指令 PUSH/PUSHA/PUSHAD/POP/POPA/POPAD、交换指令 XCHG/XLAT/BSWAP、地址或段描述符选择子传送指令 LEA/LDS/LES/LFS/LGS/LSS 等. 注意 CMOVcc 不是一条具体的指令而是一个指令簇包括大量的指令用于根据 EFLAGS 寄存器的某些位状态来决定是否执行指定的传送操作.

### 整数和逻辑运算指令

用于执行算术和逻辑运算包括加法指令 ADD/ADC、减法指令 SUB/SBB、加一指令 INC、减一指令 DEC、比较操作指令 CMP、乘法指令 MUL/IMUL、除法指令 DIV/IDIV、符号扩展指令 CBW/CWDE/CDQE、十进制调整指令 DAA/DAS/AAA/AAS、逻辑运算指令 NOT/AND/OR/XOR/TEST 等.

### 移位指令

这部分指令用于将寄存器或内存操作数移动指定的次数. 包括逻辑左移指令 SHL、逻辑右移指令 SHR、算术左移指令 SAL、算术右移指令 SAR、循环左移指令 ROL、循环右移指令 ROR 等.

### 位操作指令

这部分指令包括位测试指令 BT、位测试并置位指令 BTS、位测试并复位指令 BTR、位测试并取反指令 BTC、位向前扫描指令 BSF、位向后扫描指令 BSR 等.

### 条件设置指令

这不是一条具体的指令而是一个指令簇包括大约 30 条指令用于根据 EFLAGS 寄存器的某些位状态来设置一个 8 位的寄存器或者内存操作数. 比如 SETE/SETNE/SETGE 等等.

### 控制转移指令

这部分包括无条件转移指令 JMP、条件转移指令 Jcc/JCXZ、循环指令 LOOP/LOOPE/LOOPNE、过程调用指令 CALL、子过程返回指令 RET、中断指令 INTn、INT3、INTO、IRET 等. 注意 Jcc 是一个指令簇包含了很多指令用于根据 EFLAGS 寄存器的某些位状态来决定是否转移; INT n 是软中断指令 n 可以是 0 到 255 之间的数用于指示中断向量号.

### 串操作指令

这部分指令用于对数据串进行操作包括串传送指令 MOVS、串比较指令 CMPS、串扫描指令 SCANS、串加载指令 LODS、串保存指令 STOS 这些指令可以有选择地使用 REP/REPE/REPZ/REPNE 和 REPNZ 的前缀以连续操作.

### 输入输出指令

这部分指令用于同外围设备交换数据包括端口输入指令 IN/INS、端口输出指令 OUT/OUTS.

### 高级语言辅助指令

这部分指令为高级语言的编译器提供方便包括创建栈帧的指令 ENTER 和释放栈帧的指令 LEAVE.

### 控制和特权指令

这部分包括无操作指令 NOP、停机指令 HLT、等待指令 WAIT/MWAIT、换码指令 ESC、总线封锁指令 LOCK、内存范围检查指令 BOUND、全局描述符表操作指令 LGDT/SGDT、中断描述符表操作指令 LIDT/SIDT、局部描述符表操作指令 LLDT/SLDT、描述符段界限值加载指令 LSR、描述符访问权读取指令 LAR、任务寄存器操作指令 LTR/STR、请求特权级调整指令 ARPL、任务切换标志清零指令 CLTS、控制寄存器和调试寄存器数据传送指令 MOV、高速缓存控制指令 INVD/WBINVD/INVLPG、型号相关寄存器读取和写入指令 RDMSR/WRMSR、处理器信息获取指令 CPUID、时间戳读取指令 RDTSC 等.

### 浮点和多媒体指令

这部分指令用于加速浮点数据的运算以及用于加速多媒体数据处理的单指令多数据(SIMD 及其扩展 SSEx)指令. 这部分指令数据非常庞大无法一一列举请自行参考 INTEL 手册.

### 虚拟机扩展指令

这部分指令包括 INVEPT/INVVPID/VMCALL/VMCLEAR/VMLAUNCH/VMRESUME/VMPTRLD/VMPTRST/VMREAD/VMWRITE/VMXOFF/VMON 等

## 4. 开发环境

编译器的选择依赖于目标处理器的类型和具体的系统平台.

常用的高级语言编译器有 Microsoft 公司的 MASM 系列和 Borland 公司的 TASM(Turbo ASM)和 NASM 等编译器都是 80x86 的汇编器都是 Intel 的汇编语言语法.

Linux 下主要使用 GNU as 汇编编译器. 当然也有 nasm.

## 5. 汇编语法风格

汇编语言根据风格不同分为 Intel 风格和 AT&T 风格 Intel 风格主要使用在 Windows 下 Linux 下基本采用的是 AT&T 风格汇编(nasm 在 Linux 下面也有)两者有不同的地方.

GNU as 使用的是 AT&T 汇编语法格式.

两种汇编差异以及介绍也可以参考:

Linux/Linux 内核完全剖析—基于 0.12 内核/3.内核编程语言和环境/

通用定时器也可以用于作为等待事件 (Wait for Event,WFE) 机制的一部分生成事件流. WFE 指令将内核置于低功耗状态, 内核由事件唤醒.

关于 WFE 机制的详细信息超出了本指南的范围.

有几种方法可以生成事件, 包括:

- 在不同的内核上执行 SEV(Send Event, 发送事件)指令
- 清除内核的全局独占监视器
- 使用内核的通用定时器的事件流

通用定时器可以被配置为以固定间隔生成一系列事件. 这种配置的一个用途是生成超时. WFE 通常用于等待某个资源变为可用, 当等待时间不长时使用. 来自定时器的事件流意味着内核保持在低功耗状态的最大时间是有限的.

事件流可以从物理计数 CNTPCT_EL0 或虚拟计数 CNTPVT_EL0 生成:

- **CNTKCTL_EL1**: 控制从 CNTPVT_EL0 生成事件流
- **CNTKCTL_EL2**: 控制从 CNTPCT_EL0 生成事件流

对于每个寄存器, 控制如下:

- **EVNTEN**: 启用或禁用事件的生成
- **EVNTI**: 控制事件的频率
- **EVNTDIR**: 控制事件生成的时机

EVNTI 控制指定范围 0 到 15 中的一个比特位. 当所选位置的比特位发生变化时, 生成一个事件. 例如, 如果 EVNTI 设置为 3, 则当计数的第 3 位发生变化时生成一个事件.

EVNTDIR 控制事件是在所选比特位从 1 变为 0 还是从 0 变为 1 时生成.

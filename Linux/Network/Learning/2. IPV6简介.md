
<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [1. 为什么需要 IPV6](#1-为什么需要-ipv6)
- [2. IPV6 的优点](#2-ipv6-的优点)
  - [2.1. 更大的地址空间](#21-更大的地址空间)
  - [2.2. 点到点通信更方便](#22-点到点通信更方便)
  - [2.3. IP 配置更方便](#23-ip-配置更方便)

<!-- /code_chunk_output -->

https://segmentfault.com/a/1190000008794218

# 1. 为什么需要 IPV6

**全球的 IP 地址**由一个名字叫**IANA(Internet Assigned Numbers Authority**)的机构管理, 在它下面有**5 个分管机构**, 名字叫分别叫**AFRINIC**、**APNIC**、**ARIN**、**PIPE NCC**和**LACNIC**, 他们分别负责全球**五个不同地区的 IP 地址分配**, 中国就归**APNIC**管.

**IANA**只负责将**IP 地址**分配给下面的**5 个分管机构**, 分管机构再负责将 IP 地址分配给相关地区的网络运营商或者研究机构等.

**IPv4**的长度只有**32 位**, 总共约 42 亿的地址, 除去预**留的大约 6 亿地址**外, 实际在公网中可以被使用的地址大约只有 36 亿, 而据最新统计, 世界人口已经超过了 70 亿, 并且截至 2016 年, 人们正在使用的智能手机数量已经超过了 20 亿.

截至**2011 年 01 月 31 日**, IANA 已经将**所有的 IP 地址**分配给了下面的**5 个分管机构**, 而到 2011 年 04 月 15 日, **APNIC 的 IP 地址已经全部分配完**了, 就是说, 如果我们的中国电信、移动和联通的 IP 地址不够用的话, 已经没有地方可以申请更多的 IP 地址了.

很明显, 如果每个设备都用一个公网 IP 的话, IPv4 早就不够用了, 虽然现在用**NAT 的方式**还能坚持一段时间, 但终究不是长久之策, 我们需要一个更大的 IP 地址空间.

# 2. IPV6 的优点

## 2.1. 更大的地址空间

名字叫 IPv6, 但它的长度并不是 64 位, 而是**128 位**, 总的地址空间大约为 3.4*10^38, 一个亿是 10 的 8 次方, 那么 IPv6 就有 340 万亿亿亿亿个地址(4 个亿连一起), 所以说给地球上的每一粒沙子分配一个 IP 地址不是在吹牛, 是真可以.

可以参考[这篇文章](https://itsnobody.wordpress.com/2012/02/17/how-many-addresses-can-ipv6-hold/)和[这篇文章](http://www.npr.org/sections/krulwich/2012/09/17/161096233/which-is-greater-the-number-of-sand-grains-on-earth-or-stars-in-the-sky), 里面提到地球上所有沙滩的沙子大约有 7.5*10^18 粒, 这个值跟 IPv6 的 10^38 相差了很多个数量级, 就算加上沙漠等其它的地方, IPv6 的数量也足够覆盖它.

## 2.2. 点到点通信更方便

IPv6 完全有能力为联网的**每个设备分配一个公网 IP**, 于是我们可以**不再需要 NAT**, 从而非常方便的实现**点到点的直接通信**.

说好处之前, 先了解一下**NAT 的缺点**:

- 使用了 NAT 之后, **每次通信**都要做一次**NAT 转换**, 影响性能.

- 处于**两个不同 NAT 网络**内部的机器**不能直接通信**, 他们之间的通信得依赖第三方的服务器, 极大的限制了网络的连通性, 同时所有的数据都会被第三方所监控.

- 为了支持 NAT, 很多网络协议变得很复杂, 大大增加了网络的复杂性.

没有了 NAT 之后, 当然上面的这些缺点也就没有了, 同时会带来下面这些比较直观的好处:

- 更方便:  想象一下, 每个电脑都有公网 IP, 你电脑出了点问题, 找我帮忙看一下, 只要把你的 IP 给我, 我就可以连上去了, 而我们现在的情况是, 两个人都是内网 IP, 没法直接访问, 非得用 QQ 共享桌面之类的软件.

- 更安全:  配合点到点的加密, 让网络更安全, 不给第三方监听的机会;  以网络聊天为例, 通过使用点到点的聊天软件, 就不用担心被人监听聊天记录了; 同时访问家里的摄像头不再需要经过第三方服务器, 不用担心给别人看直播了.

## 2.3. IP 配置更方便

IPv6 有一个功能叫**Stateless Auto Configuration**, 简单点说, 就是可以**不借助 DHCP 服务器**实现**IP 地址的分配**, 插上网线就能上网.

系统起来后, 就会为每个网卡生成一个 Link-Local 的 IP 地址, 简单点说就是一个固定的前缀加上 mac 地址, 由于 mac 地址全球唯一, 所以这样构成的 IP 地址是唯一的, 有了这个地址后, 就可以局域网进行通信了, 但是这种地址路由器是不会转发的.

如果网络里有路由器;  系统会通过广播的方式问路由器, 路由器会返回一个子网前缀, 类似于 IPv4 里面的 192.168.0.0/16, 系统将子网前缀和 mac 地址组合起来, 构成了一个唯一的 IP 地址, 这个 IP 地址可以通过路由器路由.

也就是说, 就算不做任何配置, 系统启动起来后, 网卡就一定会有 IPv6 地址, 有了 IPv6 地址就可以通信.

当然 IP 地址也可以由 DHCP6 服务器来分配, 这种方式分配叫做 Stateful Auto Configuration.

局域网内更安全
由 Neighbor Discovery 代替了 IPv4 里面的 ARP 协议, 没有 ARP 后, 跟 ARP 相关的攻击就不存在了

路由更快


# 目录相关操作

---

- 比较特殊的目录:

```
.               代表此层目录
..              代表上层目录
-               代表前一个目录
~              代表"目前用户身份"所在的主文件夹
~account       代表 account 这个用户的主文件夹
```

- cd 与 cd ~意思相同, 切换到当前账户的主文件夹
- pwd 加-p 参数获取正确的目录名称, 而不是链接文件
- mkdir 加-p 会自行创建多层目录
- rmdir 加-p 会删除**空的目录**

---

# 执行文件路径的变量: $PATH

- 执行命令会在环境变量 PATH 中查找, 先查询到的先被执行.
- 将/root 目录加到 PATH 当中:

```
PATH="$PATH":/root
```

---

# 文件内容查阅

- cat: 从第一行开始显示文件
- tac: 从最后一行开始显示文件
- nl: 显示的时候, 也显示行号
- more: 一页一页地显示文件内容
- less: 与 more 类似, 但可以往前翻页
- head: 只看头几行
- tail: 只看结尾几行
- od: 以二进制的方式读取文件

---

# 修改文件时间或创建新文件: touch

- 每个文件都有许多的时间参数, 其中有三个主要的变动时间:
  - modification time(mtime): 当该文件的"内容数据 "更改时, 就会更新这个时间. 内容数据指的是文件的内容, 而不是文件的属性与权限.
  - status time(ctime): 当该文件的"状态"改变时. 像权限和属性改变, 这个时间就会更新.
  - access time(atime): 当该文件的"内容被取用"时. 像使用 cat 读取文件内容时候, 这个时间就会更新.
- 默认情况下, ls 显示的时间是该文件的 mtime, 通过 ls -l --time=atime --time=ctime file 来查看
- 如果文件的时间来自未来, 更改文件时间通过 touch 命令.

---

# 文件与目录的默认权限与隐藏权限

- 除了基本的 r、w、x 权限, 在 Linux 的 Ext2/3 文件系统下, 我们还可设置其他的系统隐藏属性, 这部分通过 chattr 设置, 以 lsattr 查看, 最重要的属性就是不可修改的特性, 文件所有者都不可改.

**文件默认权限: umask**

- umask 指定"目前用户在新建文件或目录时候的权限默认值". 查看方式有两种, 一是直接输入 umask(数字形式显示), 另一种加-S(Symbolic)参数(符号形式显示). umask 的数字形式代表"该默认值要剪掉的权限".

```
umask: 0022, 第一个 0 是特殊权限
umask -S: u=rwx, g=rx, o=rx
```

- 在默认权限上, 文件与目录不一致. 一般文件的创建不应该有 x 权限. 默认情况下:
  - 创建文件默认权限是 666, 即-rw-rw-rw-
  - 创建目录默认权限是 777, 即 drwxrwxrwx
- 新建文件时候: (-rw-rw-rw-) - (-----w--w-) = -rw-r--r--, 644
- 新建目录时候: (drwxrwxrwx) - (d----w--w-) = drwxr-xr-x, 755

**文件隐藏属性: chattr, lsattr**

- 该命令只能在 ext/3 文件系统上使用

```
chattr [+-=] [ASacdistu] 文件或目录
lsattr [-adR] 文件或目录
```

**文件特殊权限: SUID, SGID, SBIT**

Set UID, SUID

- 当 s 这个标志出现在文件所有者的 x 权限上时, 即 Set UID. 基本上 SUID 的限制和功能:
  - 仅对二进制程序(binary program)有效, 对于 shell script 无效, ;
  - 执行者对这个文件需要具有 x 的权限;
  - 本权限仅在执行该程序的过程中(run-time)有效;
  - 执行者将具有该程序所有者(owner)的权限;
  - 对于目录无效.
- SUID 程序执行过程:

![SUID 执行过程](images/fs15.PNG)

Set GID, SGID

- 当 s 标志在文件所有者的 x 权限上位 SUID, 那 s 在用户组的 x 时则为 Set GID, SGID. SGID 可以针对文件或目录来设置
- 对于文件而言:
  - SGID 对二进制程序有用
  - 程序执行者对于该程序来说, 需要具有 x 的权限
  - 执行者在执行的过程中会获得该程序用户组的支持.
- 对于文件夹而言:
  - 用户若对这个目录具有 r 与 x 的权限, 该用户能够进入此目录
  - 用户在此目录下的有效用户组(effecitive group)将会变成该目录的用户组
  - 若用户在此目录下具有 w 权限(可以新建文件), 则用户创建的文件的用户组与此目录的用户组相同

Sticky Bit, SBIT

- 对于目录有效, 对于文件没有效果. 对于目录的作用:
  - 当使用者对于此目录具有 w, x 权限, 即具有写入的权限时
  - 当使用者在该目录下创建文件或目录时, 仅自己和 root 才有权限删除该文件.
- 换句话说, 当甲这个用户对该目录是具有用户组或者其他人的身份, 并拥有该目录 w 的权限, 这表示甲用户对该目录内任何人创建的文件或目录均可进行删除/重命名/移动等操作,
# 内存地址

程序员偶尔会引用内存地址(memory address)作为访问内存单元内容的一种方式, 但是当使用 80x86 微处理器时, 必须区分以下三种不同的地址:

- 逻辑地址(logical address)

包含在机器语言指令中用来指定一个操作数或一条指令的地址. 这种使用方式在 80x86 著名的分段结构中表现尤为具体, 它促使 MS-DOS 或 Windows 程序员把程序分为若干段. 也就是我们在汇编语言中使用的, 每个逻辑地址由段(segment)和偏移量(offset 或 displacement)组成, 偏移量指明了从段开始的地方到实际地址之间的距离. 例如指定操作数地址, 这些都是逻辑地址, 逻辑地址也就是我们写程序的时候用到的地址.

- 线性地址(linear address), 也称虚拟地址(virtual address)

 是一个 32bit 无符整数, 可以用来表示 4G 的地址, 通常由 16 制数字表示. 线性地址通常用十六进制数字表示, 值范围从 0x00000000 到 0xffffffff.

 - 物理地址(physical address)

用于内存芯片级内存单元寻址, 他们与从微处理器的地址引脚发送到内存总线上的电信号相对应, 物理地址由 32bit 或 36bit 无符号整数表示. 虽然可以直接把物理地址理解成插在机器上那根内存本身, 把内存看成一个从 0 字节一直到最大空量逐字节的编号的大数组, 然后把这个数组叫做物理地址, 但是事实上, 这只是一个硬件提供给软件的抽像, 内存的寻址方式并不是这样. 所以, 说它是"与地址总线相对应", 是更贴切一些.

内存控制单元(MMU)将逻辑地址通过分段单元(Segmentation UNIT)转换成线性地址, 将线性地址通过分页单元(Page UNIT)转换为物理地址.

在多处理器系统中, 所有 CPU 都共享同一内存; 这意味着 RAM 芯片可以由独立的 CPU 并发地访问. 因为在 RAM 芯片上的读或写操作必须串行地执行, 因此一种所谓内存仲裁器(memory arbiter)的硬件电路插在总线和每个 RAM 芯片之间. 其作用是如果某个 RAM 芯片空闲, 就准允一个 CPU 访问, 如果该芯片忙于为另一个处理器提出的请求服务, 就延迟这个 CPU 的访问. 即使在单处理器上也使用内存仲裁器, 因为单处理器系统中包含了一个叫做 DMA 控制器的特殊处理器, 而 DMA 控制器与 CPU 并发操作[参见"直接内存访问(DMA)"]. 在多处理器系统的情况下, 因为仲裁器有多个输入端口, 所以结构更复杂. 例如, 双 Pentium 在每个芯片的入口维持了一个两端口仲裁器, 并在试图使用公用总线前请求两个 CPU 交换同步信息. 从编程观点看, 因为仲裁器由硬件电路管理, 因此它是隐藏的.













































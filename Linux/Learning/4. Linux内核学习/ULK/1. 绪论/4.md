
### Unix 文件系统概述

#### 文件

Unix 的每个进程都有一个当前工作目录, 它属于进程执行上下文(execution context), 标识出进程所用的当前目录. 为了标识一个特定的文件, 进程使用路径名(pcothname), 路径名由斜杠及一列指向文件的目录名交替组成.

当标识文件名时, 也可用符号"."、"..".

#### 硬链接和软链接

>
可以参考 Linux 部分的文件系统部分
http://note.youdao.com/noteshare?id=4761d3972e3f4e9ef1805b38ea92273d

包含在目录中的文件名就是一个文件的硬链接(hard link), 或简称链接(link). 在同一目录或不同目录中, 同一个文件可以有几个链接, 因此对应几个文件名.

硬链接不允许用户给目录创建. 还有就是因为可能把目录树变成环形图, 从而就不能通过名字定位一个文件.

#### 文件类型

Unix 可以是下列类型之一:

- 普通文件(regular file)
- 目录
- 符号链接
- 面向块的设备文件(block-oriented device file)
- 面向字符的设备文件(character-oriented device file)
- 管道(pipe)和命名管道(named pipe)(也叫 FIFO)
- 套接字(socket)

#### 文件描述符和索引节点

Unix 对文件的内容和描述文件的信息给出了清楚的区分. 除了设备文件和特殊文件系统文件外, 每个文件都由字符序列组成. 文件内容不包含任何控制信息, 如文件长度或文件结束(end-of-file,EOF)符.

#### 文件操作的系统调用

用户访问一个文件的内容, 实际上是访问存储在硬件块设备上的一些数据. 处于用户态的进程不能直接与底层硬件交互, 所以每个实际文件操作必须在内核态下进行.

##### 打开文件

为打开一个文件, 进程调用系统调用:

>
fd = open(path, flag, mode)

其中三个参数有以下含义:

path: 表示文件的路径
flag: 文件的打开方式. 它也指定了是否应当创建一个不存在的文件.
mode: 指定新创建文件的访问权限

返回文件描述符(file description)的标识符.

##### 访问打开的文件

对于普通 Unix 文件, 可以顺序访问, 也可以随机访问, 而对于设备文件和命令管道文件, 通常只能顺序地访问. 内核把文件指针存放在打开文件对象中, 也就是说, 当前位置就是下一次进行读或写操作的位置. 当打开文件时, 内核让文件指针指向文件的第一个字节(偏移量为 0).

##### 关闭文件

##### 更名及删除文件

重命名或删除文件是不需要打开的. 实际上只是对一个或多个目录起作用.